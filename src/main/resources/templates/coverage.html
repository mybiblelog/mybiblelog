<!DOCTYPE html>
<html layout:decorate="~{layout}">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>My Bible Log</title>
</head>

<body>
	<div layout:fragment="content">

    <script type="text/x-template" id="completion-bar">
      <div :style="backgroundStyle">
        <div :style="foregroundStyle"></div>
      </div>
    </script>

    <script type="text/x-template" id="bible-report">
      <div>
        <header>
          <h2>Coverage Report</h2>
        </header>

        <div>
          <p>Total Bible Verses: {{ totalBibleVerses }}</p>
          <p>Unique Verses Read: {{ totalVersesRead }}</p>
          <p>Percent Complete: {{ percentageRead }}%</p>
        </div>

        <completion-bar :percentage="percentageRead"></completion-bar>

        <table class="coverage-table">
          <thead>
            <tr>
              <th>Book</th>
              <th>Verses Read</th>
              <th>Total Verses</th>
              <th>Percent Complete</th>
            </tr>
          </thead>
          <template v-for="report in allBookReports"> 
            <tr @click="$emit('view-book-report', report.bookIndex)">
              <td>{{ report.bookName }}</td>
              <td>{{ report.versesRead }}</td>
              <td>{{ report.totalVerses }}</td>
              <td>{{ report.percentage }}%</td>
            </tr>
            <tr @click="$emit('view-book-report', report.bookIndex)">
              <td colspan=4>
                <completion-bar :percentage="report.percentage"></completion-bar>
              </td>
            </tr>
          </template>
        </table>
      </div>
    </script>
		
    <script type="text/x-template" id="book-report">
      <div>
        <header>
          <h2>Book Report: {{ book.name }}</h2>
        </header>
        <button @click="$emit('exit-book-report')">Go Back</button>
      </div>
    </script>
		
		<div id="js-vue-app" v-cloak class="page-column">
      <bible-report
        v-if="view == 'bible'"
        :log-entries="logEntries"
        @view-book-report="viewBookReport($event)"
        ></bible-report>
      <book-report
        v-if="view == 'book'"
        :log-entries="logEntries"
        :book-index="bookIndex"
        @exit-book-report="viewBibleReport"
        ></book-report>
    </div>
    
  </div>
  <div layout:fragment="bodyscripts">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
    <script src="/js/coverage.vue.js"></script>
  </div>
</body>

</html>